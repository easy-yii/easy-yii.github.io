<!DOCTYPE html>
<html lang="zh-CN">

<!-- Head tag -->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <!--Description-->
  
  <meta name="description" content="hacking-with-yii2">
  

  <!--Author-->
  
  <meta name="author" content="ç¼˜è²åº¦">
  

  <!--Open Graph Title-->
  
      <meta property="og:title" content="migrations"/>
  
  <!--Open Graph Description-->
  
      <meta property="og:description" content="hacking-with-yii2" />
  
  <!--Open Graph Site Name-->
  <meta property="og:site_name" content="hacking-with-yii2"/>
  <!--Type page-->
  
      <meta property="og:type" content="article" />
  
  <!--Page Cover-->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <!-- Title -->
  
  <title>migrations - hacking-with-yii2</title>


  <link rel="shortcut icon" href="https://static.hinpc.com/image/2016/20160807-hi-logo.png">

  <!-- Custom CSS/Sass -->
  <link rel="stylesheet" href="/css/style.css">

  <!----------------------------
  https://github.com/GallenHu/hexo-theme-Daily

 _____            _   _
|  __ \          (_) | |
| |  | |   __ _   _  | |  _   _
| |  | |  / _` | | | | | | | | |
| |__| | | (_| | | | | | | |_| |
|_____/   \__,_| |_| |_|  \__, |
                          __/ |
                         |___/

    --------------------------->

</head>


<body>

  <!-- Nav -->
  <header class="site-header">
  <div class="header-inside">
    <div class="logo">
      <a href="/" rel="home">
        
        <img src="https://avatars3.githubusercontent.com/u/23000895?v=3&s=200" alt="hacking-with-yii2" height="60">
        
      </a>
    </div>
    <!-- Navigation -->
    <nav class="navbar">
      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse">
        <ul class="navbar-nav">
          
          
            <li>
              <a href="/.">
                
                  Home
                
              </a>
            </li>
          
            <li>
              <a href="/archives">
                
                  Archive
                
              </a>
            </li>
          
            <li>
              <a href="/about">
                
                  About
                
              </a>
            </li>
          
        </ul>
      </div>
      <!-- /.navbar-collapse -->
    </nav>
    <div class="button-wrap">
      <button class="menu-toggle">Primary Menu</button>
    </div>
  </div>
</header>


  <!-- Main Content -->
  <div class="content-area">
  <div class="post">
    <!-- Post Content -->
    <div class="container">
      <article>
        <!-- Title date & tags -->
        <div class="post-header">
          <h1 class="entry-title">
            migrations
            
          </h1>
          <p class="posted-on">
          2016-12-06
          </p>
          <div class="tags-links">
            
              
            
          </div>
        </div>
        <!-- Post Main Content -->
        <div class="entry-content">
          <blockquote>
<p>å‰è¨€ï¼šè¿™æ˜¯ä¸€ä¸ªyii2ä¸“é¢˜ï¼Œä»å¦‚ä½•ä½¿ç”¨yii2åˆ°åˆ†æyii2æºç ï¼Œåˆ°æœ€åæ€è€ƒå¦‚ä½•è®¾è®¡ä¸€ä¸ªæ¡†æ¶ã€‚æœ¬äººä¼šè‡´åŠ›äºå†™çš„å¾ˆè¯¦ç»†ã€‚(PS:å¸Œæœ›æˆ‘èƒ½åšæŒä¸‹å»ï¼Œä¸ä¼šæ‰“è„¸ğŸ™ˆ)
æœ¬æ–‡ä¸»è¦è®²è¿°äº†ï¼Œå¦‚ä½•ä½¿ç”¨è¿ç§»ï¼Œå»ºç«‹æ•°æ®åº“ï¼Œå¹¶æ¶‰åŠåˆ°ä¸€ç‚¹å„¿å…³äºè®¾è®¡æ•°æ®åº“çš„æ€è€ƒã€‚æœ¬æ–‡çš„ç»“æ„ï¼Œ<code>steps</code>éƒ¨åˆ†ï¼Œå¸¦é¢†å¤§å®¶ä¸€æ­¥æ­¥å°è¯•ï¼›æ€»ç»“éƒ¨åˆ†ï¼Œåœ¨èµ°å®Œä¹‹åï¼Œåšä¸ªå°ç»“ï¼Œå¦‚å¸¸ç”¨å‘½ä»¤Listï¼Œå¦‚ä¸€äº›æ€è€ƒã€‚
æ‰€ä»¥æœ¬æ–‡æ—¢å¯ä»¥å½“æˆæ•™ç¨‹ï¼Œä¹Ÿå¯ä»¥å½“æˆä¸€ä¸ªæŸ¥çœ‹æ‰‹å†Œï¼Œæ¯”å¦‚å¿˜è®°æŸä¸ªå‘½ä»¤ï¼Œå¯ä»¥ç›´æ¥è·³åˆ°æ€»ç»“é‚£éƒ¨åˆ†æŸ¥æ‰¾ã€‚</p>
</blockquote>
<h2 id="steps"><a class="header-anchor" href="#steps">Â¶</a>steps</h2>
<h3 id="step-one-æ•°æ®åº“é…ç½®"><a class="header-anchor" href="#step-one-æ•°æ®åº“é…ç½®">Â¶</a>step one æ•°æ®åº“é…ç½®</h3>
<p>æœ¬æ–‡é‡‡ç”¨çš„æ˜¯yii2-advancedç‰ˆæœ¬ï¼Œåœ¨common/config/main-local.phpæ–‡ä»¶é…ç½®ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">return</span> [</div><div class="line">    <span class="string">'components'</span> =&gt; [</div><div class="line">        <span class="string">'db'</span> =&gt; [</div><div class="line">            <span class="string">'class'</span> =&gt; <span class="string">'yii\db\Connection'</span>,</div><div class="line">            <span class="string">'dsn'</span> =&gt; <span class="string">'mysql:host=localhost;dbname=æ•°æ®åº“åå­—'</span>,</div><div class="line">            <span class="string">'username'</span> =&gt; <span class="string">'mysqlè®¿é—®ç”¨æˆ·'</span>,</div><div class="line">            <span class="string">'password'</span> =&gt; <span class="string">'å¯†ç '</span>,</div><div class="line">            <span class="string">'charset'</span> =&gt; <span class="string">'utf8'</span>,</div><div class="line">        ],</div><div class="line">    ],</div><div class="line">];</div></pre></td></tr></table></figure>
<h3 id="step-two-åˆ›å»ºè¿ç§»æ–‡ä»¶"><a class="header-anchor" href="#step-two-åˆ›å»ºè¿ç§»æ–‡ä»¶">Â¶</a>step two åˆ›å»ºè¿ç§»æ–‡ä»¶</h3>
<p><strong>æ³¨æ„ï¼Œæœ¬æ–‡ä½¿ç”¨çš„å‘½ä»¤è¡Œï¼Œå¸¦æœ‰phpï¼Œå› ä¸ºæœ¬äººå¹¶æœªå°†<code>yii</code>è®¾ç½®ä¸ºcommand</strong></p>
<p>æ‰§è¡Œ <code>php yii migrate/create post</code> åï¼Œç»ˆç«¯ä¼šè¾“å‡ºä¸€åˆ™æ¶ˆæ¯è¯¢é—®ä½ ï¼Œæ˜¯å¦åˆ›å»ºè¯¥æ–‡ä»¶ï¼Œè¾“å…¥ <code>yes</code> å³å¯ã€‚å¦‚ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Yii Migration Tool (based on Yii v2<span class="number">.0</span><span class="number">.9</span>)</div><div class="line">Create <span class="keyword">new</span> migration <span class="string">'/Users/yuan/PhpstormProjects/chg/console/migrations/m161023_120328_post.php'</span>? (yes|no) [no]:yes</div><div class="line"><span class="keyword">New</span> migration created successfully.</div></pre></td></tr></table></figure>
<p>åˆ›å»ºçš„æ–‡ä»¶åœ¨<code>console/migrations</code>ç›®å½•ä¸‹ï¼Œæ–‡ä»¶å<code>m161023_120328_post.php</code></p>
<h3 id="step-three-å»ºç«‹è¡¨ç»“æ„"><a class="header-anchor" href="#step-three-å»ºç«‹è¡¨ç»“æ„">Â¶</a>step three å»ºç«‹è¡¨ç»“æ„</h3>
<p>2.06ä»¥åçš„ç‰ˆæœ¬ï¼Œæä¾›äº†æ›´ç®€ä¾¿åˆ›å»ºåˆ—çš„æ–¹æ³•ã€‚æˆ‘ä»¬å°†å„ç§ç±»å‹çš„åˆ—è¯•ä¸€ä¸‹ã€‚è¯¦ç»†å¯å‚ç…§<a href="http://www.yiiframework.com/doc-2.0/yii-db-schemabuildertrait.html" target="_blank" rel="external">yii\db\SchemaBuilderTrait</a></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">up</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">	    <span class="keyword">$this</span>-&gt;createTable(<span class="string">'posts'</span>,[</div><div class="line">		    <span class="string">'id'</span> =&gt; <span class="keyword">$this</span>-&gt;primaryKey(),</div><div class="line">		    <span class="string">'big_integer'</span> =&gt; <span class="keyword">$this</span>-&gt;bigInteger(),</div><div class="line">		    <span class="string">'binary'</span> =&gt; <span class="keyword">$this</span>-&gt;binary(),</div><div class="line">		    <span class="string">'boolean'</span> =&gt; <span class="keyword">$this</span>-&gt;boolean(),</div><div class="line">		    <span class="string">'char'</span> =&gt; <span class="keyword">$this</span>-&gt;char(),</div><div class="line">		    <span class="string">'date'</span> =&gt; <span class="keyword">$this</span>-&gt;date(),</div><div class="line">		    <span class="string">'date_time'</span> =&gt; <span class="keyword">$this</span>-&gt;dateTime(),</div><div class="line">		    <span class="string">'decimal'</span> =&gt; <span class="keyword">$this</span>-&gt;decimal(),</div><div class="line">		    <span class="string">'double'</span> =&gt; <span class="keyword">$this</span>-&gt;double(),</div><div class="line">		    <span class="string">'float'</span> =&gt; <span class="keyword">$this</span>-&gt;float(),</div><div class="line">		    <span class="string">'integer'</span> =&gt; <span class="keyword">$this</span>-&gt;integer()-&gt;notNull()-&gt;defaultValue(<span class="number">1</span>),</div><div class="line">		    <span class="string">'money'</span> =&gt; <span class="keyword">$this</span>-&gt;money(),</div><div class="line">		    <span class="string">'small_integer'</span> =&gt; <span class="keyword">$this</span>-&gt;smallInteger(),</div><div class="line">		    <span class="string">'string'</span> =&gt; <span class="keyword">$this</span>-&gt;string(<span class="number">64</span>),</div><div class="line">		    <span class="string">'text'</span> =&gt; <span class="keyword">$this</span>-&gt;text(),</div><div class="line">		    <span class="string">'time'</span> =&gt; <span class="keyword">$this</span>-&gt;time(),</div><div class="line">		    <span class="string">'timestamp'</span> =&gt; <span class="keyword">$this</span>-&gt;timestamp()</div><div class="line">	    ]);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">down</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;dropTable(<span class="string">'posts'</span>);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p><code>up</code>æ–¹æ³•ï¼Œåˆ›å»ºè¡¨ç»“æ„ï¼›<code>down</code>æ–¹æ³•ï¼Œç”¨äºå›æ»š<code>up</code>æ–¹æ³•ä¸­çš„æ“ä½œã€‚æœ€åï¼Œå†è¯¦ç»†è¯´ä¸‹æ¯ç§åˆ—çš„ç±»å‹ã€‚</p>
<h3 id="step-four-è¿ç§»"><a class="header-anchor" href="#step-four-è¿ç§»">Â¶</a>step four è¿ç§»</h3>
<p>æ‰§è¡Œ<code>php yii migrate</code>å³å¯ï¼Œæ­¤æ—¶å¯ä»¥çœ‹ä¸€ä¸‹æ•°æ®åº“å¯¹åº”åˆ—çš„ç±»å‹</p>
<h3 id="step-five-æ·»åŠ åˆ—-å¤–é”®-ç´¢å¼•-åˆ é™¤åˆ—-å¤–é”®-ç´¢å¼•"><a class="header-anchor" href="#step-five-æ·»åŠ åˆ—-å¤–é”®-ç´¢å¼•-åˆ é™¤åˆ—-å¤–é”®-ç´¢å¼•">Â¶</a>step five æ·»åŠ åˆ—ã€å¤–é”®ã€ç´¢å¼•ï¼Œåˆ é™¤åˆ—ã€å¤–é”®ã€ç´¢å¼•</h3>
<p>åœ¨åˆšåˆšå»ºçš„<code>posts</code>è¡¨ä¸­æ·»åŠ æ–°çš„åˆ—ï¼Œå¹¶æ·»åŠ å¤–é”®ã€ç´¢å¼•ã€‚</p>
<p>åˆ›å»ºæ‰§è¡Œå‘½ä»¤<code>php yii migrate/create update_posts</code>,åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„æ–‡ä»¶<code>m161023_132017_update_posts.php</code>ã€‚</p>
<p>åœ¨æ–‡ä»¶ä¸­æ·»åŠ ä»£ç ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">up</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">	    <span class="keyword">$this</span>-&gt;addColumn(<span class="string">'posts'</span>, <span class="string">'author_id'</span>, <span class="keyword">$this</span>-&gt;integer());</div><div class="line">	    <span class="keyword">$this</span>-&gt;addColumn(<span class="string">'posts'</span>, <span class="string">'category_id'</span>, <span class="keyword">$this</span>-&gt;integer());</div><div class="line">	    <span class="keyword">$this</span>-&gt;addColumn(<span class="string">'posts'</span>, <span class="string">'title'</span>, <span class="keyword">$this</span>-&gt;string());</div><div class="line">	    <span class="keyword">$this</span>-&gt;addColumn(<span class="string">'posts'</span>, <span class="string">'body'</span>, <span class="keyword">$this</span>-&gt;text());</div><div class="line"></div><div class="line">	    <span class="keyword">$this</span>-&gt;createIndex(</div><div class="line">		    <span class="string">'idx-posts-author_id'</span>,</div><div class="line">		    <span class="string">'posts'</span>,</div><div class="line">		    <span class="string">'author_id'</span></div><div class="line">	    );</div><div class="line"></div><div class="line">	    <span class="keyword">$this</span>-&gt;addForeignKey(</div><div class="line">		    <span class="string">'fk-posts-author_id'</span>,</div><div class="line">		    <span class="string">'posts'</span>,</div><div class="line">		    <span class="string">'author_id'</span>,</div><div class="line">		    <span class="string">'user'</span>,</div><div class="line">		    <span class="string">'id'</span>,</div><div class="line">		    <span class="string">'CASCADE'</span></div><div class="line">	    );</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">down</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">	    <span class="keyword">$this</span>-&gt;dropForeignKey(</div><div class="line">		    <span class="string">'fk-posts-author_id'</span>,</div><div class="line">		    <span class="string">'posts'</span></div><div class="line">	    );</div><div class="line"></div><div class="line">	    <span class="keyword">$this</span>-&gt;dropIndex(</div><div class="line">		    <span class="string">'idx-posts-author_id'</span>,</div><div class="line">		    <span class="string">'posts'</span></div><div class="line">	    );</div><div class="line">	    <span class="keyword">$this</span>-&gt;dropColumn(<span class="string">'posts'</span>, <span class="string">'author_id'</span>);</div><div class="line">	    <span class="keyword">$this</span>-&gt;dropColumn(<span class="string">'posts'</span>, <span class="string">'category_id'</span>);</div><div class="line">	    <span class="keyword">$this</span>-&gt;dropColumn(<span class="string">'posts'</span>, <span class="string">'title'</span>);</div><div class="line">	    <span class="keyword">$this</span>-&gt;dropColumn(<span class="string">'posts'</span>, <span class="string">'body'</span>);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>æ³¨æ„:åœ¨<code>up</code>æ–¹æ³•ä¸­ï¼Œå…ˆåˆ›å»ºç´¢å¼•ï¼Œå†åˆ›å»ºå¤–é”®ï¼›åœ¨<code>down</code>æ–¹æ³•ä¸­ï¼Œåˆ é™¤å¤–é”®ï¼Œå†åˆ é™¤ç´¢å¼•ã€‚</p>
<ul>
<li>åˆ›å»ºç´¢å¼•çš„æ–¹æ³•:$this-&gt;createIndex(â€˜idx-è¡¨å-å­—æ®µâ€™,â€˜è¡¨åâ€™,â€˜å­—æ®µâ€™);<a href="http://www.yiiframework.com/doc-2.0/yii-db-command.html#createIndex()-detail" target="_blank" rel="external">æ–¹æ³•è¯¦æƒ…</a></li>
<li>åˆ›å»ºå¤–é”®çš„æ–¹æ³•:$this-&gt;addForeignKey(â€˜fk-è¡¨å-å­—æ®µâ€™,â€˜è¡¨åâ€™,â€˜å­—æ®µâ€™,â€˜å…³è”çš„è¡¨åâ€™,â€˜å…³è”çš„è¡¨æ˜ä¸­çš„å­—æ®µâ€™, â€˜CASCADEâ€™);<a href="http://www.yiiframework.com/doc-2.0/yii-db-command.html#addForeignKey()-detail" target="_blank" rel="external">æ–¹æ³•è¯¦æƒ…</a></li>
</ul>
<p><strong>æƒ³è¿›ä¸€æ­¥å­¦ä¹ ï¼Œå»¶ä¼¸å¤–é”®ã€ç´¢å¼•æ–¹é¢çš„çŸ¥è¯†ï¼Œå¯ä»¥çœ‹åº•éƒ¨ç›¸å…³é“¾æ¥ã€‚</strong></p>
<h3 id="step-six-äº‹åŠ¡"><a class="header-anchor" href="#step-six-äº‹åŠ¡">Â¶</a>step six äº‹åŠ¡</h3>
<p>å½“éœ€è¦ä¿è¯æ¯ä¸€æ­¥å¯¹æ•°æ®åº“çš„æ“ä½œéƒ½è¦æˆåŠŸæ—¶ï¼Œå¦‚æœä¸­é—´æœ‰ä»»ä½•ä¸€æ­¥å¯¹æ•°æ®åº“çš„æ“ä½œå¤±è´¥ï¼Œæˆ‘ä»¬éƒ½å¸Œæœ›æ’¤é”€ä¹‹å‰å¯¹æ•°æ®åº“çš„æ“ä½œã€‚
æˆ‘ä»¬è¿™ä¸ªæ—¶å€™å³éœ€è¦ç”¨åˆ°äº‹åŠ¡ï¼Œå®ƒå¯ä»¥ä¿è¯æ•°æ®åº“çš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§ã€‚</p>
<p>åœ¨yii2ä¸­ï¼Œå¦‚ä½•å®ç°å‘¢ï¼Œéå¸¸ç®€å•ã€‚åªéœ€å°†<code>save()</code>,<code>down()</code>æ–¹æ³•åˆ†åˆ«æ›¿æ¢æˆ<code>safeUp()</code>,<code>safeDown()</code>å³å¯ã€‚</p>
<h3 id="step-seven-æ¢å¤è¿ç§»"><a class="header-anchor" href="#step-seven-æ¢å¤è¿ç§»">Â¶</a>step seven æ¢å¤è¿ç§»</h3>
<p>æ¢å¤è¿ç§»çš„æ„æ€æ˜¯ï¼Œæ’¤é”€å¯¹æ•°æ®åº“çš„æ“ä½œã€‚å¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå°è¯•çœ‹çœ‹ã€‚</p>
<ul>
<li>è¿˜åŸæœ€è¿‘ä¸€æ¬¡æäº¤çš„è¿ç§»: <code>php yii migrate/down</code></li>
<li>è¿˜åŸæœ€è¿‘ä¸‰æ¬¡æäº¤çš„è¿ç§»: <code>php yii migrate/down 3</code></li>
</ul>
<p>è¿˜æœ‰ç›¸å…³é‡åšè¿ç§»ã€æŸ¥çœ‹è¿ç§»å†å²ã€ä¿®æ”¹è¿ç§»å†å²ï¼Œè¿™é‡Œä¸å¤šè¯´ï¼Œçœ‹ä¸€ä¸‹æ€»ç»“éƒ¨åˆ†ï¼è¿ç§»å‘½ä»¤ï¼Œå¹¶å°è¯•ä¸€ä¸‹ã€‚</p>
<h3 id="step-eight-ä½¿ç”¨å‘½ä»¤è¡Œé€‰é¡¹"><a class="header-anchor" href="#step-eight-ä½¿ç”¨å‘½ä»¤è¡Œé€‰é¡¹">Â¶</a>step eight ä½¿ç”¨å‘½ä»¤è¡Œé€‰é¡¹</h3>
<h4 id="interactive"><a class="header-anchor" href="#interactive">Â¶</a><code>interactive</code></h4>
<p>é»˜è®¤ä¸ºtrueã€‚æ¯æ¬¡æ‰§è¡Œmigrateä¹‹å‰ï¼Œä¼šæç¤ºç”¨æˆ·ï¼Œè¾“å…¥yes or noï¼Œå¦‚æœè®¾ç½®ä¸ºfalseï¼Œåˆ™å¯çœå»è¿™äº›æç¤ºã€‚
ä½¿ç”¨å¦‚ï¼š</p>
<ul>
<li><code>php yii migrate --interactive=0</code></li>
<li><code>php yii migrate/down 1 --interactive=0</code></li>
</ul>
<h4 id="migrationpath"><a class="header-anchor" href="#migrationpath">Â¶</a>migrationPath</h4>
<p>é»˜è®¤å€¼æ˜¯ï¼Œ@app/migrationsã€‚æ˜¯å­˜æ”¾è¿ç§»æ–‡ä»¶çš„ç›®å½•ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨æ¨¡å—(modules)å¼€å‘,ä¸€èˆ¬æ¯ä¸ªæ¨¡å—ä¹Ÿä¼šæœ‰å­˜æ”¾è¿ç§»æ–‡ä»¶çš„ç›®å½•ã€‚
å½“è¿ç§»æ¨¡å—é‡Œçš„è¿ç§»æ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦æŒ‡å®šè¿ç§»è·¯å¾„ã€‚<a href="http://www.yiichina.com/doc/guide/2.0/structure-modules" target="_blank" rel="external">å…³äºæ¨¡å—æ›´å¤šçš„äº†è§£ï¼Œè¯·ç‚¹å‡»æ­¤</a>
ä½¿ç”¨å¦‚ï¼š<code>yii migrate --migrationPath=@app/modules/forum/migrations</code></p>
<h4 id="db"><a class="header-anchor" href="#db">Â¶</a>db</h4>
<p>string (é»˜è®¤å€¼ä¸º db)ï¼ŒæŒ‡å®šæ•°æ®åº“ application component çš„ IDã€‚ å®ƒæŒ‡çš„æ˜¯å°†ä¼šè¢«è¯¥å‘½ä»¤è¿ç§»çš„æ•°æ®åº“ã€‚</p>
<p>åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œé…ç½®ä¸€ä¸ªdb2ï¼Œå¦‚ä½•é…ç½®çœ‹step oneã€‚ä½¿ç”¨<code>yii migrate --db=db2</code>ï¼Œå³å¯è¿ç§»åˆ°idä¸ºdb2çš„æ•°æ®åº“ã€‚</p>
<p>ä¹Ÿå¯ä»¥è¿™æ ·,åœ¨ä»£ç ä¸­æŒ‡å®šæ•°æ®åº“çš„idï¼Œè™½ç„¶ä»¥ä¸‹çš„è¿ç§»ä¼šè¿ç§»åˆ°idä¸ºdb2çš„æ•°æ®åº“ä¸­ï¼Œä½†æ˜¯è¿ç§»å†å²ä¿¡æ¯ä¼šæ”¾åœ¨idä¸ºdbçš„æ•°æ®åº“ä¸­ã€‚
å¦‚æœå¾ˆå¤šè¿ç§»æ–‡ä»¶ï¼Œåˆ°è¦è¿ç§»åˆ°idä¸ºdb2çš„æ•°æ®åº“ä¸­ï¼Œå¯ä»¥å°†<code>init()</code>éƒ¨åˆ†ä»£ç å°è£…æˆä¸€ä¸ªåŸºç±»ï¼Œè®©è¦è¿ç§»åˆ°idä¸ºdb2çš„æ•°æ®åº“çš„è¿ç§»
æ–‡ä»¶ç»§æ‰¿è¿™ä¸ªåŸºç±»å°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="keyword">use</span> <span class="title">yii</span>\<span class="title">db</span>\<span class="title">Migration</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">m150101_185401_create_news_table</span> <span class="keyword">extends</span> <span class="title">Migration</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">init</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;db = <span class="string">'db2'</span>;</div><div class="line">        <span class="keyword">parent</span>::init();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="templatefile"><a class="header-anchor" href="#templatefile">Â¶</a>templateFile</h4>
<p>é»˜è®¤çš„æ¨¡ç‰ˆæ–‡ä»¶æ˜¯@yii/views/migration.phpï¼Œæ–‡ä»¶ä½ç½®åœ¨<code>vendor/yiisoft/yii2/views/migration.php</code>ã€‚</p>
<p>è¯¥é€‰é¡¹çš„å€¼ï¼Œå¯ä»¥æ˜¯æ–‡ä»¶è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯è·¯å¾„åˆ«åã€‚</p>
<h4 id="generatortemplatefiles"><a class="header-anchor" href="#generatortemplatefiles">Â¶</a>generatorTemplateFiles</h4>
<p>æ¨¡ç‰ˆç”Ÿæˆå™¨ï¼Œé»˜è®¤å€¼æ˜¯ä¸‹é¢æ•°ç»„ã€‚æ•°ç»„ä¸­çš„å¥å³æ˜¯ï¼Œä¸Šä¸€å°ç»“çš„åˆ«åã€‚ä»¥ä¸‹æ–‡ä»¶ä½ç½®éƒ½åœ¨<code>vendor/yiisoft/yii2/views/</code>ç›®å½•ä¸‹ã€‚
å¦‚ä½•åˆ›å»ºä¸€ä¸ªæ–°çš„æ¨¡ç‰ˆï¼Œå¯èƒ½è¦ä¿®æ”¹æ¡†æ¶æºç ã€‚æœ‰å…´è¶£çš„å¯è¯¦ç»†ç ”ç©¶<code>yii\console\controllers\MigrateController</code>æºç ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">array</span>(</div><div class="line"> <span class="string">'create_table'</span> =&gt; <span class="string">'@yii/views/createTableMigration.php'</span>,</div><div class="line">  <span class="string">'drop_table'</span> =&gt; <span class="string">'@yii/views/dropTableMigration.php'</span>,</div><div class="line">  <span class="string">'add_column'</span> =&gt; <span class="string">'@yii/views/addColumnMigration.php'</span>,</div><div class="line">  <span class="string">'drop_column'</span> =&gt; <span class="string">'@yii/views/dropColumnMigration.php'</span>,</div><div class="line">  <span class="string">'create_junction'</span> =&gt; <span class="string">'@yii/views/createJunctionMigration.php'</span></div><div class="line">);</div></pre></td></tr></table></figure>
<h4 id="fields"><a class="header-anchor" href="#fields">Â¶</a>fields</h4>
<p>åœ¨åˆ›å»ºè¿ç§»æ–‡ä»¶æ—¶ï¼Œå°±å£°æ˜å­—æ®µå’Œå­—æ®µç±»å‹ã€‚åˆ›å»ºå®Œæˆåï¼Œè¿ç§»æ–‡ä»¶ä¼šåŒ…æ‹¬è¿™äº›å·²å£°æ˜çš„å­—æ®µã€‚</p>
<p><code>yii migrate/create create_post --fields=&quot;title:string,body:text&quot;</code></p>
<h2 id="æ€»ç»“"><a class="header-anchor" href="#æ€»ç»“">Â¶</a>æ€»ç»“</h2>
<h3 id="yiiå­—æ®µç±»å‹-vs-æ•°æ®åº“ç±»å‹"><a class="header-anchor" href="#yiiå­—æ®µç±»å‹-vs-æ•°æ®åº“ç±»å‹">Â¶</a>Yiiå­—æ®µç±»å‹  VS æ•°æ®åº“ç±»å‹</h3>
<p>åœ¨ step three ä¸­ï¼Œæˆ‘ä»¬å°†Yii2æä¾›çš„åˆ›å»ºä¸åŒæ•°æ®åº“å­—æ®µç±»å‹çš„æ–¹æ³•éƒ½è¯•äº†ä¸€ä¸‹ï¼Œç°åœ¨æˆ‘ä»¬ç®€å•æ€»ç»“å¹¶åˆ†æä¸‹ã€‚</p>
<table>
<thead>
<tr>
<th>Yii2</th>
<th>æ•°æ®åº“Type</th>
<th>Length</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>primaryKey()</td>
<td>INT</td>
<td>11</td>
<td>Extra:auto_incrementï¼›ä¸»é”®ï¼›ä¸€èˆ¬è¡¨ä¸­éƒ½ä¼šæœ‰ä¸€ä¸ªè‡ªå¢é•¿idï¼Œé»˜è®¤ä¸ºä¸»é”®ã€‚</td>
</tr>
<tr>
<td>bigInteger()</td>
<td>BIGINT</td>
<td>20</td>
<td></td>
</tr>
<tr>
<td>binary()</td>
<td>BLOB</td>
<td></td>
<td>äºŒè¿›åˆ¶</td>
</tr>
<tr>
<td>boolean()</td>
<td>TINYINT</td>
<td>1</td>
<td>å¸ƒå°”ç±»å‹</td>
</tr>
<tr>
<td>char()</td>
<td>CHAR</td>
<td>1</td>
<td>å­˜å®šé•¿ï¼Œä¸å¯å˜ï¼Œé€Ÿåº¦å¿«ï¼Œå­˜åœ¨æµªè´¹ç©ºé—´çš„å¯èƒ½ ï¼Œä¼šå¤„ç†å°¾éƒ¨ç©ºæ ¼ï¼Œä¸Šé™255</td>
</tr>
<tr>
<td>date()</td>
<td>DATE</td>
<td></td>
<td>æ—¥æœŸï¼ŒYYYY-MM-DD</td>
</tr>
<tr>
<td>dateTime()</td>
<td>DATETIME</td>
<td></td>
<td>æ—¥æœŸå’Œæ—¶é—´ï¼ŒYYYY-MM-DD  HH:MM:SS</td>
</tr>
<tr>
<td>decimal()</td>
<td>DECIMAL</td>
<td>10,0</td>
<td>é»˜è®¤(10,0),decimal(p,s)ï¼Œpæ•´æ•°ä½ï¼Œså°æ•°ä½ï¼›åœ¨é‡‘èè¡Œä¸šï¼Œè®¾è®¡æ•°æ®åº“çš„æ—¶å€™ï¼Œæ¶‰åŠåˆ°é‡‘é¢ã€åˆ©ç‡ç»å¸¸ä½¿ç”¨æ­¤ç±»å‹</td>
</tr>
<tr>
<td>float()</td>
<td>FLOAT</td>
<td>10,0</td>
<td></td>
</tr>
<tr>
<td>integer()</td>
<td>INT</td>
<td>11</td>
<td></td>
</tr>
<tr>
<td>money()</td>
<td>DECIMAL</td>
<td>19,4</td>
<td>moneyï¼Œå…¶å®æœ¬è´¨è¿˜æ˜¯decimalç±»å‹ï¼Œä¸åŒåœ¨äºç²¾è¯»ï¼Œæ•´æ•°ä½19ï¼Œå°æ•°ä½4ã€‚</td>
</tr>
<tr>
<td>smallInteger()</td>
<td>SMALLINT</td>
<td>6</td>
<td></td>
</tr>
<tr>
<td>string()</td>
<td>VARCHAR</td>
<td>255</td>
<td>å­˜å˜é•¿ï¼Œé€Ÿåº¦æ…¢ï¼Œä¸å­˜åœ¨ç©ºé—´æµªè´¹ï¼Œä¸å¤„ç†å°¾éƒ¨ç©ºæ ¼ï¼Œä¸Šé™65535ï¼Œä½†æ˜¯æœ‰å­˜å‚¨é•¿åº¦å®é™…65532æœ€å¤§å¯ç”¨ã€‚</td>
</tr>
<tr>
<td>text()</td>
<td>TEXT</td>
<td></td>
<td>å­˜å˜é•¿å¤§æ•°æ®ï¼Œé€Ÿåº¦æ…¢ï¼Œä¸å­˜åœ¨ç©ºé—´æµªè´¹ï¼Œä¸å¤„ç†å°¾éƒ¨ç©ºæ ¼ï¼Œä¸Šé™65535ï¼Œä¼šç”¨é¢å¤–ç©ºé—´å­˜æ”¾æ•°æ®é•¿åº¦ï¼Œé¡¾å¯ä»¥å…¨éƒ¨ä½¿ç”¨65535ã€‚</td>
</tr>
<tr>
<td>timestamp()</td>
<td>TIMESTAMP</td>
<td></td>
<td>é»˜è®¤å€¼ï¼šCURRENT_TIMESTAMP;Extra:on update CURRENT_TIMESTAMPï¼›æ—¶é—´æˆ³ï¼ŒUnixçºªå…ƒï¼Œ1970-01-01 00:00:00 UTCæ—¶é—´ æœ€å¤§åˆ°ï¼š2038-01-09 03:14:07 UTC</td>
</tr>
</tbody>
</table>
<h4 id="attention-å…³äºæ•°æ®åº“è®¾è®¡çš„ä¸€ç‚¹æ€è€ƒ"><a class="header-anchor" href="#attention-å…³äºæ•°æ®åº“è®¾è®¡çš„ä¸€ç‚¹æ€è€ƒ">Â¶</a>Attention å…³äºæ•°æ®åº“è®¾è®¡çš„ä¸€ç‚¹æ€è€ƒ</h4>
<ul>
<li><a href="http://www.cnblogs.com/billyxp/p/3548540.html" target="_blank" rel="external">MySQLä¹‹charã€varcharå’Œtextçš„è®¾è®¡</a></li>
<li><a href="https://segmentfault.com/q/1010000000655428" target="_blank" rel="external">æ—¶é—´å­˜æ—¶é—´æˆ³è¿˜æ˜¯æ ¼å¼åŒ–çš„æ—¶é—´ï¼Ÿdatetimeã€timestampã€è¿˜æ˜¯bigintï¼Ÿ</a></li>
</ul>
<h3 id="æ•°æ®åº“è®¿é—®æ–¹æ³•"><a class="header-anchor" href="#æ•°æ®åº“è®¿é—®æ–¹æ³•">Â¶</a>æ•°æ®åº“è®¿é—®æ–¹æ³•</h3>
<p>è¯¦æƒ…çœ‹<a href="http://www.yiiframework.com/doc-2.0/yii-db-migration.html" target="_blank" rel="external">API</a></p>
<ul>
<li><code>yii\db\Migration::execute($sql,$params = [])</code> æ‰§è¡Œä¸€æ¡ SQLè¯­å¥</li>
<li><code>yii\db\Migration::insert($table, $columns )</code> æ’å…¥å•è¡Œæ•°æ®</li>
<li><code>yii\db\Migration::batchInsert($table, $columns, $rows)</code> æ’å…¥å¤šè¡Œæ•°æ®</li>
<li><code>yii\db\Migration::update($table, $columns, $condition = '', $params = [] )</code> æ›´æ–°æ•°æ®</li>
<li><code>yii\db\Migration::delete($table, $condition = '', $params = [])</code> åˆ é™¤æ•°æ®</li>
<li><code>yii\db\Migration::createTable()</code> åˆ›å»ºä¸€å¼ è¡¨</li>
<li><code>yii\db\Migration::renameTable()</code> é‡å‘½åè¡¨æ˜</li>
<li><code>yii\db\Migration::dropTable()</code> åˆ é™¤ä¸€å¼ è¡¨</li>
<li><code>yii\db\Migration::truncateTable()</code> æ¸…é™¤ä¸€å¼ è¡¨çš„æ•°æ®</li>
<li><code>yii\db\Migration::addColumn()</code> æ·»åŠ ä¸€åˆ—</li>
<li><code>yii\db\Migration::renameColumn()</code> é‡å‘½åå­—æ®µåç§°</li>
<li><code>yii\db\Migration::dropColumn()</code> ç§»å‡ºåˆ—</li>
<li><code>yii\db\Migration::alterColumn()</code> ä¿®æ”¹å­—æ®µ</li>
<li><code>yii\db\Migration::addPrimaryKey()</code> æ·»åŠ ä¸€ä¸ªä¸»é”®</li>
<li><code>yii\db\Migration::dropPrimaryKey()</code> ç§»é™¤ä¸€ä¸ªä¸»é”®</li>
<li><code>yii\db\Migration::addForeignKey()</code> æ·»åŠ ä¸€ä¸ªå¤–é”®</li>
<li><code>yii\db\Migration::dropForeignKey()</code> ç§»é™¤å¤–é”®</li>
<li><code>yii\db\Migration::createIndex()</code> åˆ›å»ºä¸€ä¸ªç´¢å¼•</li>
<li><code>yii\db\Migration::dropIndex()</code> ç§»é™¤ä¸€ä¸ªç´¢å¼•</li>
<li><code>yii\db\Migration::addCommentOnColumn()</code> æ·»åŠ æŸä¸ªå­—æ®µçš„æ³¨é‡Š</li>
<li><code>yii\db\Migration::dropCommentFromColumn()</code> ç§»é™¤æŸä¸ªå­—æ®µçš„æ³¨é‡Š</li>
<li><code>yii\db\Migration::addCommentOnTable()</code> æ·»åŠ æŸå¼ è¡¨çš„æ³¨é‡Š</li>
<li><code>yii\db\Migration::dropCommentFromTable()</code> ç§»é™¤æŸå¼ è¡¨çš„æ³¨é‡Š</li>
</ul>
<p>éƒ¨åˆ†ç¤ºä¾‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">$this</span>-&gt;execute(<span class="string">"insert into news (title,content) VALUES ('insert','insert');"</span>); <span class="comment">//æš‚æ—¶ä¸æ¸…æ¥šï¼Œ$paramsåˆ°åº•è¦ä¼ ä»€ä¹ˆï¼Ÿ</span></div><div class="line"></div><div class="line"><span class="keyword">$this</span>-&gt;insert(<span class="string">'news'</span>, [<span class="string">'title'</span> =&gt; <span class="string">'test 1'</span>,<span class="string">'content'</span> =&gt; <span class="string">'content 1'</span>]);</div><div class="line"></div><div class="line"><span class="keyword">$this</span>-&gt;batchInsert(<span class="string">'news'</span>,[<span class="string">'title'</span>,<span class="string">'content'</span>],[<span class="number">0</span>=&gt;[<span class="string">'insert1'</span>,<span class="string">'content1'</span>],<span class="number">1</span>=&gt;[<span class="string">'insert2'</span>,<span class="string">'content2'</span>]]);</div><div class="line"></div><div class="line"><span class="keyword">$this</span>-&gt;delete(<span class="string">'news'</span>, [<span class="string">'id'</span> =&gt; <span class="number">1</span>]);</div><div class="line"></div><div class="line"><span class="keyword">$this</span>-&gt;createTable(<span class="string">'news'</span>, [<span class="string">'id'</span> =&gt; <span class="keyword">$this</span>-&gt;primaryKey(),<span class="string">'title'</span> =&gt; <span class="keyword">$this</span>-&gt;string()-&gt;notNull(),<span class="string">'content'</span> =&gt; <span class="keyword">$this</span>-&gt;text(),]);</div><div class="line">	    </div><div class="line"><span class="keyword">$this</span>-&gt;truncateTable(<span class="string">'news'</span>);</div><div class="line"></div><div class="line"><span class="keyword">$this</span>-&gt;dropTable(<span class="string">'news'</span>);</div><div class="line"></div><div class="line"><span class="keyword">$this</span>-&gt;dropForeignKey(<span class="string">'fk-posts-author_id'</span>,<span class="string">'posts'</span>);</div><div class="line">  </div><div class="line"> <span class="keyword">$this</span>-&gt;addForeignKey(<span class="string">'fk-posts-author_id'</span>,<span class="string">'posts'</span>,<span class="string">'author_id'</span>,<span class="string">'user'</span>,<span class="string">'id'</span>,<span class="string">'CASCADE'</span>);</div><div class="line">        	    </div><div class="line"><span class="keyword">$this</span>-&gt;dropIndex(<span class="string">'idx-posts-author_id'</span>,<span class="string">'posts'</span>);</div><div class="line"></div><div class="line"><span class="keyword">$this</span>-&gt;createIndex(<span class="string">'idx-posts-author_id'</span>,<span class="string">'posts'</span>,<span class="string">'author_id'</span>);</div><div class="line">        	    </div><div class="line"><span class="keyword">$this</span>-&gt;dropColumn(<span class="string">'posts'</span>, <span class="string">'body'</span>);</div></pre></td></tr></table></figure>
<h3 id="è¿ç§»å‘½ä»¤"><a class="header-anchor" href="#è¿ç§»å‘½ä»¤">Â¶</a>è¿ç§»å‘½ä»¤</h3>
<p>å½“ä½ å¿˜è®°è¿ç§»å‘½ä»¤æ—¶ï¼Œä½ åªéœ€åœ¨æ§åˆ¶å°æ‰§è¡Œï¼Œ<code>php yii help migrate</code>ï¼Œå³å¯çœ‹åˆ°ç›¸å…³migrateå‘½ä»¤ï¼Œå¯ä»¥çœå»æŸ¥çœ‹æ–‡æ¡£çš„æ—¶é—´ã€‚</p>
<ul>
<li>åˆ›å»ºè¿ç§»(<code>name</code>å‚æ•°åº”å½“åªåŒ…å«å­—æ¯ã€ä¸‹åˆ’çº¿ã€æ•°å­—): <code>php yii migrate/create name</code></li>
<li>æ‰§è¡Œè¿ç§»: <code>php yii migrate</code> å³ <code>php yii migrate/up</code></li>
<li>è¿˜åŸæœ€è¿‘ä¸€æ¬¡æäº¤çš„è¿ç§»: <code>php yii migrate/down</code></li>
<li>è¿˜åŸæœ€è¿‘ä¸‰æ¬¡æäº¤çš„è¿ç§»: <code>php yii migrate/down 3</code></li>
<li>é‡åšæœ€è¿‘ä¸€æ¬¡æäº¤çš„è¿ç§»: <code>yii migrate/redo</code></li>
<li>é‡åšæœ€è¿‘ä¸‰æ¬¡æäº¤çš„è¿ç§»:  <code>yii migrate/redo 3</code></li>
<li>æ˜¾ç¤ºæœ€è¿‘10æ¬¡æäº¤çš„è¿ç§»: <code>yii migrate/history</code></li>
<li>æ˜¾ç¤ºæœ€è¿‘5æ¬¡æäº¤çš„è¿ç§»: <code>yii migrate/history 5</code></li>
<li>æ˜¾ç¤ºæ‰€æœ‰å·²ç»æäº¤è¿‡çš„è¿ç§»: <code>yii migrate/history all</code></li>
<li>æ˜¾ç¤ºå‰10ä¸ªè¿˜æœªæäº¤çš„è¿ç§»: <code>yii migrate/new</code></li>
<li>æ˜¾ç¤ºå‰5ä¸ªè¿˜æœªæäº¤çš„è¿ç§»: <code>yii migrate/new 5</code></li>
<li>æ˜¾ç¤ºæ‰€æœ‰è¿˜æœªæäº¤çš„è¿ç§»:  <code>yii migrate/new all</code></li>
</ul>
<h3 id="æ€è€ƒ"><a class="header-anchor" href="#æ€è€ƒ">Â¶</a>æ€è€ƒ</h3>
<p>Question Oneï¼šåœ¨ä¸ªäººçœ‹æ¥ï¼Œä½¿ç”¨Migrationå°†æ•°æ®åº“ä¹Ÿçº³å…¥ç‰ˆæœ¬ç®¡ç†ï¼Œå¯ä»¥æ›´å¥½æ–¹ä¾¿çš„ç®¡ç†æ•°æ®åº“å¹¶çºªå½•æ•°æ®åº“çš„å˜åŒ–ï¼Œçºªå½•æ•°æ®åº“åœ¨å“ªä¸ª
æ—¶é—´ç‚¹åˆ›å»ºäº†æ•°æ®åº“ï¼Œä¿®æ”¹äº†æ•°æ®åº“ã€‚ç”šè‡³å¯ä»¥é€šè¿‡ç‰ˆæœ¬å·¥å…·ï¼Œå¦‚<code>Git</code>ï¼ŒçŸ¥é“å“ªä½å°ç»„æˆå‘˜æ”¹äº†æ•°æ®åº“ã€‚ä½†ï¼Œæœ¬äººç¢°åˆ°è¿™ä¹ˆä¸€ä¸ªè§‚ç‚¹ã€‚è¿™ä¸ª
è§‚ç‚¹æ˜¯ï¼Œä½¿ç”¨è¿ç§»å·¥å…·ä¸å®‰å…¨ã€‚ä¼šé€ æˆå‘˜å·¥å¯èƒ½å› ä¸ºä¸ªäººæƒ…ç»ªèƒ¡ä¹±ä¿®æ”¹æ•°æ®åº“æˆ–è€…åˆ é™¤æ•°æ®åº“ã€‚ä¸ªäººè§‰å¾—ï¼Œåœ¨ä¸€èˆ¬å¼€å‘ä¸­ï¼Œèµ·ç æœ‰ä¸‰ä¸ªç¯å¢ƒï¼šå¼€å‘ç¯å¢ƒã€æµ‹è¯•ç¯å¢ƒã€çº¿ä¸Šç¯å¢ƒã€‚
åœ¨ä¸Šçº¿ä¹‹å‰ï¼Œæ˜¯è‚¯å®šè¦åœ¨æµ‹è¯•ç¯å¢ƒæµ‹è¯•è¿‡çš„ã€‚ä¸€èˆ¬é…ç½®æ–‡ä»¶ï¼Œå¦‚æ•°æ®åº“é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥è®¾ç½®é»˜è®¤ä¸ä¸Šä¼ ã€‚è€Œä¸Šçº¿ï¼Œåˆæ˜¯ä¸€èˆ¬æœ‰ä¸“é—¨çš„äººè´Ÿè´£éƒ¨ç½²ã€‚å›¢é˜Ÿå¯èƒ½ä¼šå› ä¸ºå¤§å°ï¼Œ
éƒ¨åˆ†æˆå‘˜ä¹Ÿè¦è´Ÿè´£éƒ¨ç½²ã€‚å¹¶ä¸ä¼šéšä¾¿è®©ä»€ä¹ˆäººä¿®æ”¹æ•°æ®åº“ã€‚ä¸çŸ¥é“å¤§å®¶å¯¹äºä½¿ç”¨Migrationå¯¹å®‰å…¨çš„å¨èƒæœ‰ä»€ä¹ˆçœ‹æ³•ï¼Ÿ</p>
<blockquote>
<p>åè®°ï¼Œmigrationåªæ˜¯å¸®åŠ©æˆ‘ä»¬æ›´å¥½çš„ç®¡ç†æ•°æ®åº“ã€‚å®ƒçš„æ ¸å¿ƒè¿˜æ˜¯å¦‚ä½•è®¾è®¡æ•°æ®åº“ï¼Œå»ºè®®åˆšå¼€å§‹å­¦ä¹ PHPçš„ç«¥é‹ä»¬ï¼Œè¡¥å……ä¸€ä¸‹å…³äºæ•°æ®åº“çš„çŸ¥è¯†ã€‚å¦‚ï¼Œ
åŸºæœ¬çš„sqlè¯­æ³•ã€è¡¨ä¹‹é—´çš„å…³è”å…³ç³»ã€äº‹åŠ¡ã€æ‚²è§‚é”ã€æ•°æ®åº“å¼•æ“ç­‰ã€‚</p>
</blockquote>
<h2 id="å»¶ä¼¸"><a class="header-anchor" href="#å»¶ä¼¸">Â¶</a>å»¶ä¼¸:</h2>
<ul>
<li><a href="http://blog.51yip.com/mysql/1136.html" target="_blank" rel="external">mysql å¤–é”®</a></li>
<li><a href="https://segmentfault.com/a/1190000003072424" target="_blank" rel="external">mysql ç´¢å¼•</a></li>
<li><a href="https://github.com/YuanLianDu/YLD-with-Php/blob/master/articles/mysql/engine.md" target="_blank" rel="external">mysql å­˜å‚¨å¼•æ“çš„é€‰æ‹©</a></li>
<li><a href="https://github.com/yiisoft/yii2-app-advanced/blob/master/docs/guide/start-comparison.md" target="_blank" rel="external">é«˜çº§ç‰ˆæœ¬å’ŒåŸºç¡€ç‰ˆæœ¬çš„åŒºåˆ«</a></li>
</ul>

        </div>
      </article>
    </div>
    <!-- Comments -->
    <div class="container">
      
<section id="comment">
  <!-- <h1 class="title">ç•™è¨€</h1> -->

  
    <!-- å¤šè¯´è¯„è®ºæ¡† start -->
    <div class="ds-thread" data-thread-key="post-migrations" data-title="migrations" data-url="http://easy-yii.github.io/2016/12/06/migrations/"></div>
    <!-- å¤šè¯´è¯„è®ºæ¡† end -->
  
</section>

    </div>
    <!-- Pre or Next -->
    <div class="nav-links">
      
        <div class="nav-previous">
          <a href="/2016/12/06/model-1/" rel="prev"><span class="meta-arraw meta-arraw-left"></span> ä¸Šä¸€é¡µ</a>
        </div>
      
      
    </div>

  </div>
</div>


  <!-- Footer -->
  <!-- Footer-widgets -->
<div class="footer-widgets">
  <div class="row inside-wrapper">
    <div class="col-1-3">
      <aside>
        <h1 class="widget-title">å…³äºæœ¬ç«™</h1>
        <div class="custom-widget-content">
          
          <p align="left">ä¸€æ­¥ä¸€ä¸ªè„šå°ï¼Œç»†è‡´åœ°å­¦ä¹ Yii2ï¼Œä»å®è·µåˆ°é˜…è¯»æºç ã€‚</p>
        </div>
      </aside>
    </div>
    <div class="col-1-3">
      <aside>
        <h1 class="widget-title">ä¸æˆ‘è”ç³»</h1>
        <div class="widget-text">
          
            
              <a href="https://github.com/YuanLianDu" class="icon icon-github" target="_blank">github</a>
            
              <a href="mailto:yuanliandu@qq.com" class="icon icon-mail" target="_blank">mail</a>
            
          
        </div>
      </aside>
    </div>
    <div class="col-1-3">
      <aside>
        <h1 class="widget-title">ç«™å†…æœç´¢</h1>
        <div class="widget-text">
          <form onSubmit="return appDaily.submitSearch('')">
            <p>
              <input type="text" placeholder="search..." id="homeSearchInput">
            </p>
            <!-- <input type="submit" value="GO"> -->
          </form>
        </div>
      </aside>
    </div>
  </div>
</div>
<!-- Footer -->
<footer class="site-info">
  <p>
    <span>hacking-with-yii2 &copy; 2016</span>
    
      <span class="split">|</span><span>Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> with Theme <a href="https://github.com/GallenHu/hexo-theme-Daily" target="_blank">Daily</a></span>
    
  </p>
</footer>


  <!-- After footer scripts -->
  <!-- scripts -->
<script src="//cdn.bootcss.com/zepto/1.2.0/zepto.min.js"></script>
<script src="/js/app.js"></script>

  <!-- å¤šè¯´å…¬å…±JSä»£ç  start (ä¸€ä¸ªç½‘é¡µåªéœ€æ’å…¥ä¸€æ¬¡) -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:'easy-yii'};
      (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0]
         || document.getElementsByTagName('body')[0]).appendChild(ds);
      })();
      </script>
    <!-- å¤šè¯´å…¬å…±JSä»£ç  end -->



</body>

</html>